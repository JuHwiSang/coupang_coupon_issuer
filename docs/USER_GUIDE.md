# 쿠팡 쿠폰 자동발급 프로그램 사용설명서

> 매일 자정에 자동으로 쿠폰을 발급하는 프로그램입니다.

---

## 📋 목차

1. [설치 방법](#설치-방법)
2. [엑셀 파일 작성](#엑셀-파일-작성)
3. [확인 방법](#확인-방법)
4. [제거 방법](#제거-방법)
5. [⚠️ 주의사항](#️-주의사항)
6. [문제 해결](#문제-해결)

---

## 설치 방법

### 0. 필요한 정보 준비

설치하기 전에 다음 정보를 준비하세요:

- **Access Key / Secret Key**: 쿠팡 판매자 센터 → API 관리에서 발급
- **Vendor ID**: 쿠팡 판매자 센터 로그인 후 URL에서 확인 (`vendorId=12345`)
- **User ID**: 쿠팡 판매자 센터 로그인 ID
- **옵션ID**: 쿠팡 판매자 센터 → 상품 관리 → 상품 상세에서 확인

<details>
<summary><b>📖 자세한 방법 보기 (클릭)</b></summary>

#### Access Key / Secret Key 발급

1. 쿠팡 판매자 센터(https://wing.coupang.com) 로그인
2. 상단 메뉴 → **API 관리** 클릭
3. **새 API 키 발급** 버튼 클릭
4. Access Key와 Secret Key 복사 (Secret Key는 한 번만 보여줍니다!)

#### Vendor ID 확인

1. 쿠팡 판매자 센터 로그인
2. 브라우저 주소창 URL 확인
3. `vendorId=12345` 형태로 표시된 숫자가 Vendor ID입니다

예: `https://wing.coupang.com/...?vendorId=12345` → Vendor ID는 `12345`

#### User ID 확인

쿠팡 판매자 센터 로그인 시 사용하는 ID입니다.

- **옵션ID**: 쿠팡 판매자 센터 → 상품 관리 → 상품 상세에서 확인
    - **즉시할인쿠폰**: 최대 10,000개까지 가능
    - **다운로드쿠폰**: 최대 100개까지만 가능
- 여러 옵션에 적용하려면 쉼표로 구분 (예: `123456, 789012`)

</details>

### 1. 엑셀 파일 준비

프로그램 폴더의 `examples` 폴더에서 파일 하나를 복사해서 이름을 `coupons.xlsx`로 바꾸세요.

```
basic.xlsx → coupons.xlsx (이름 변경)
```

엑셀 파일을 열어서 쿠폰 정보를 입력하세요. (자세한 내용은 [엑셀 파일 작성](#엑셀-파일-작성) 참고)

### 2. 서버에 업로드

프로그램 폴더와 `coupons.xlsx` 파일을 리눅스 서버에 업로드하세요.

**중요**: `coupons.xlsx` 파일은 반드시 프로그램 폴더 안에 넣으세요!

```
~/coupang_coupon_issuer/
├── main.py
├── src/
└── coupons.xlsx  ← 여기!
```

### 3. 설치 실행

터미널(SSH)로 서버에 접속해서 다음 3줄을 실행하세요:

```bash
cd ~/coupang_coupon_issuer
sudo python3 main.py setup
python3 main.py install .
```

마지막 줄 실행하면 API 키를 입력하라고 나옵니다. 차례대로 입력하면 설치 완료!

---

## 엑셀 파일 작성

### 엑셀 구조 (9개 컬럼)

| 컬럼 | 이름 | 예시 |
|------|------|------|
| A | 쿠폰이름 | "신규회원 10% 할인" |
| B | 쿠폰타입 | "즉시할인쿠폰" 또는 "다운로드쿠폰" |
| C | 쿠폰유효기간 | 30 (일 단위) |
| D | 할인방식 | "정률할인", "정액할인", "수량별 정액할인" |
| E | 할인금액/비율 | 10 (10% 또는 10원) |
| F | 최소구매금액 | 10000 (원 단위, 다운로드쿠폰만) |
| G | 최대할인금액 | 5000 (원 단위) |
| H | 발급개수 | 100 (다운로드쿠폰만) |
| I | 옵션ID | "123456, 789012" (쉼표로 구분) |

### 🚨 절대 지켜야 할 규칙

- ❌ **컬럼 순서, 개수, 이름을 절대 바꾸지 마세요**
- ❌ **헤더(첫 번째 줄)를 수정하지 마세요**
- ✅ **데이터 행만 추가/수정/삭제하세요**

> 형식을 조금이라도 바꾸면 프로그램이 동작하지 않습니다!

### 작성 예시

**즉시할인 쿠폰**:
- 쿠폰이름: VIP 20% 할인
- 쿠폰타입: 즉시할인
- 쿠폰유효기간: 30
- 할인방식: 정률할인
- 할인금액/비율: 20
- 최소구매금액: (비워둠)
- 최대할인금액: 50000
- 발급개수: (비워둠)
- 옵션ID: 1234567890, 9876543210

**다운로드 쿠폰**:
- 쿠폰이름: 신규회원 3000원 할인
- 쿠폰타입: 다운로드쿠폰
- 쿠폰유효기간: 15
- 할인방식: 정액할인
- 할인금액/비율: 3000
- 최소구매금액: 10000
- 최대할인금액: 3000
- 발급개수: 500
- 옵션ID: 3226138951, 4802314648

---

## 확인 방법

### 엑셀 파일 검증

엑셀 파일을 수정한 후 검증하세요:

```bash
cd ~/coupang_coupon_issuer
python3 main.py verify .
```

정상이면 "검증 완료" 메시지가 나옵니다.

### 수동 실행 (테스트)

자정까지 기다리지 않고 바로 실행해보려면:

```bash
cd ~/coupang_coupon_issuer
python3 main.py issue .
```

### 로그 확인

실행 결과를 확인하려면:

```bash
cat ~/coupang_coupon_issuer/issuer.log
```

### 스케줄 확인

자동 실행이 등록되었는지 확인:

```bash
crontab -l
```

---

## 제거 방법

```bash
cd ~/coupang_coupon_issuer
python3 main.py uninstall .
rm -rf ~/coupang_coupon_issuer
```

---

## ⚠️ 주의사항

### 1. 폴더를 옮기지 마세요

설치 후 프로그램 폴더를 다른 위치로 옮기면 자동 실행이 작동하지 않습니다.

**폴더를 옮겨야 한다면**:
1. `uninstall` 실행
2. 폴더 이동
3. 새 위치에서 `install` 다시 실행

### 2. 쿠폰 예산 차감

쿠폰을 발급하면 쿠팡의 "자유계약" 예산에서 비용이 차감됩니다.

### 3. 엑셀 파일명 고정

엑셀 파일 이름은 반드시 `coupons.xlsx`여야 합니다.

### 4. 엑셀 형식 엄수

엑셀 파일 형식을 조금이라도 바꾸면 프로그램이 동작하지 않습니다.

### 5. 검증 명령어 활용

엑셀 파일을 수정한 후에는 `verify` 명령어로 검증하세요.

---

## 문제 해결

### 오류가 발생했을 때

1. **로그 파일 확인**
   ```bash
   cat ~/coupang_coupon_issuer/issuer.log
   ```

2. **엑셀 파일 검증**
   ```bash
   cd ~/coupang_coupon_issuer
   python3 main.py verify .
   ```

3. **개발자에게 문의**
   - `issuer.log` 파일을 개발자에게 보내주세요
   - 프로그램 폴더를 압축해서 함께 보내면 더 빠르게 해결됩니다

### 자주 발생하는 오류

**"Cron이 설치되어 있지 않습니다"**
```bash
sudo python3 main.py setup
```

**"엑셀 파일을 찾을 수 없습니다"**
- 파일 이름이 `coupons.xlsx`인지 확인
- 파일이 프로그램 폴더 안에 있는지 확인

**"API 에러"**
- API 키가 올바른지 확인
- 로그 파일을 개발자에게 전달

**"엑셀 형식 오류"**
- `verify` 명령어로 어떤 부분이 잘못되었는지 확인
- 예제 파일과 비교해보세요

---

**마지막 업데이트**: 2025-12-26  
**버전**: 3.0
