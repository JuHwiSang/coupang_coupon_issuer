# ADR 001: 엑셀 입력 구조

> **주의**: 이 문서는 [ADR 009: 엑셀 6컬럼 구조](009-excel-6-column-structure.md)로 대체되었습니다.
>
> 5컬럼 구조는 '발급개수' 컬럼이 할인금액/비율과 발급개수를 동시에 표현하는 문제가 있어 6컬럼 구조로 변경되었습니다.

**상태**: ~~승인됨~~ **대체됨 (Superseded by ADR 009)**
**날짜**: 2024-12-16
**결정자**: 프로젝트 오너
**대체일**: 2024-12-17

## 컨텍스트

쿠폰 발급 시스템의 입력 방법으로 엑셀 파일을 사용하기로 결정했습니다. 일반 사용자(비개발자)가 쿠폰 정보를 입력하므로, 구조는 최대한 단순해야 하며 입력 실수를 허용할 수 있어야 합니다.

## 결정사항

### 엑셀 파일 구조

5개 컬럼만 사용:

| 컬럼명 | 설명 | 예시 |
|--------|------|------|
| 쿠폰이름 | 쿠폰 명칭 | "신규회원 할인" |
| 쿠폰타입 | 즉시할인 또는 다운로드쿠폰 | "즉시할인" |
| 쿠폰유효기간 | 발급일로부터 며칠간 유효 | "2" (2일) |
| 할인방식 | RATE/FIXED_WITH_QUANTITY/PRICE | "RATE" |
| 발급개수 | 생성할 쿠폰 개수 | "100" |

### 파일 위치

- **입력 파일**: `coupons.xlsx` (issuer.py와 동일 디렉토리)
- **결과 파일**: `results/result_YYYYMMDD_HHMMSS.xlsx`

### 고정값 (사용자 입력 불필요)

다음 값들은 config.py에 고정:

- **예산**: `-1` (무제한)
- **최소 구매금액**: `0` (제한없음)
- **최대 할인금액**: `10000` (기본값)
- **유효 시작일**: 실행일 0시 0분 0초
- **contract_id**: `-1` (고정값)
- **user_id, vendor_id**: 설치 시 수집하여 credentials.json에 저장

## 근거

1. **단순성**: 일반 사용자가 쿠폰 생성 시 신경써야 할 항목을 최소화
2. **일관성**: 모든 쿠폰이 동일한 예산/계약 정책 사용
3. **오류 방지**: 잘못된 날짜/ID 입력 가능성 제거
4. **자동화**: 매일 0시 실행되므로 시작일은 자동 계산

## 대안

1. **모든 필드를 엑셀에 포함**: 너무 복잡하고 오류 발생 가능성 높음 (거부됨)
2. **JSON/YAML 설정 파일**: 비개발자가 편집하기 어려움 (거부됨)
3. **Web UI**: 개발 비용이 너무 높음 (향후 고려)

## 영향

- 엑셀 파일은 5개 컬럼만 포함
- config.py에 고정값 상수 추가 필요
- issuer.py에서 엑셀 읽기/쓰기 로직 구현 필요
- 입력 정규화 로직 필수 (ADR 002 참조)
